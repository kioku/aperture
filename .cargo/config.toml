[build]
# NOTE: To optimize for your local CPU, set in your shell profile:
#   export RUSTFLAGS="-Ctarget-cpu=native"
# Do NOT set rustflags here â€” it causes SIGILL in CI when cached
# proc-macro artifacts are reused across runners with different CPUs.

# Faster incremental builds (commented out - lld not available on all systems)
# [target.x86_64-unknown-linux-gnu]
# rustflags = ["-Clink-arg=-fuse-ld=lld"]

# [target.x86_64-apple-darwin]  
# rustflags = ["-Clink-arg=-fuse-ld=lld"]

# Test configuration
[env]
# Disable debug output in tests for performance
RUST_LOG = { value = "off", condition = { env-not-set = ["RUST_LOG"] } }

# Speed up compilation
CARGO_INCREMENTAL = "1"
CARGO_BUILD_JOBS = "0"  # Use all available cores

# Test-specific aliases
[alias]
test-unit = "test --lib"
test-integration = "test --test '*' --features integration"
test-all = "test --workspace --features integration"
test-fast = "nextest run --profile fast"
test-ci = "nextest run --profile ci"